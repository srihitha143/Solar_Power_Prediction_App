# -*- coding: utf-8 -*-
"""train_model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1OceFzt2ZxPcAvcwOMDUKSuPy_mHRJV3T
"""

import pandas as pd
import xgboost as xgb
from sklearn.model_selection import train_test_split

# 1. Load the data
# Make sure 'solarpowergeneration.csv' is in the same directory
df = pd.read_csv('solarpowergeneration.csv')

# 2. Define features (X) and target (y)
feature_cols = [
    'distance-to-solar-noon', 'temperature', 'wind-direction',
    'wind-speed', 'sky-cover', 'visibility', 'humidity',
    'average-wind-speed-(period)', 'average-pressure-(period)'
]
target_col = 'power-generated'

X = df[feature_cols]
y = df[target_col]

# 3. Split the data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 4. Initialize and Train the XGBoost Model
# Using a base set of parameters (you can replace with your hyper-tuned params)
xgb_model = xgb.XGBRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=5,
    random_state=42
)

print("Training XGBoost Regressor...")
xgb_model.fit(X_train, y_train)
print("Training complete.")

# 5. Save the trained model
model_filename = 'solar_power_model.json'
xgb_model.save_model(model_filename)
print(f"Model saved successfully as: {model_filename}")